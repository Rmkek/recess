// Generated by CoffeeScript 2.0.2
var fs, globby, path;

path = require('path');

fs = require('fs-extra');

globby = require('globby');

module.exports = function(punk) {
  var plugin, reporter;
  reporter = punk.reporter;
  plugin = {};
  plugin.pipes = {
    add: function(settings) {
      if (!Array.isArray(settings)) {
        settings = [settings];
      }
      // PIPE #
      return async function(files, cond) {
        var paths;
        // get paths
        paths = globby.sync(settings, {
          cwd: cond.workdir
        });
        // no files at input
        if (paths.length === 0) {
          reporter.noFiles(settings);
        }
        // load files
        await punk.d.eachAsync(paths, async function(pth) {
          var contents;
          contents = (await fs.readFile(path.resolve(cond.workdir, pth)));
          files.push(new punk.File(pth, contents));
        });
        return files;
      };
    }
  };
  plugin.pipes.load = plugin.pipes.add;
  return plugin;
};
