var fs,mdeps,path,setImmediate,stp,svg,type;mdeps=require("module-deps"),fs=require("fs"),path=require("path"),type=require("file-type"),stp=require("stream-to-promise"),svg=require("is-svg"),({setImmediate:setImmediate}=require("timers")),module.exports=function(e,r){var t;return t={exists:function(e){try{return fs.accessSync(e),!0}catch(e){return!1}},deps:function(e){return new Promise(function(r,t){var n;return n=mdeps(),stp(n).then(function(e){return r(e)}),n.end({file:e})})},bufferizeFiles:function(e){var r,t;for(t in e)r=e[t],e[t]=Buffer.from(r);return e},toPromise:function(e){return e instanceof Promise?e:new Promise(function(r,t){var n;try{return r(e)}catch(e){return n=e,t(n)}})},getExt:function(e=""){var r;return(r=path.extname(e).split("."))[r.length-1]},getType:function(e,r){var n,i;(i=type(r))||(i={ext:t.getExt(e)}),n=i.ext;try{svg(r)&&(n="svg")}catch(e){}return n},mapAsync:function(e,t,n=function(){}){return new Promise(function(n,i){var s,u,o,a,p;s=Array.isArray(e),o=s?[]:{},0===e.length&&n(o),a=[];for(u in e)p=e[u],s&&(u-=0),a.push(function(i,s){return setImmediate(async function(){var u;if((u=t(s,i))instanceof Promise&&u.catch(function(e){return r.error(e)}),o[i]=await u,Object.keys(e).length===Object.keys(o).length)return n(o)})}(u,p));return a})},eachAsync:function(e,t,n=function(){}){return new Promise(function(n,i){var s,u,o,a,p;a=0,s=0,o=[];for(u in e)p=e[u],ir&&(u-=0),o.push(function(e,i){return a++,setImmediate(async function(){var u;if((u=t(i,e))instanceof Promise&&u.catch(function(e){return r.error(e)}),results[e]=await u,s++,a===s)return n(results)})}(u,p));return o})},toSetting:function(r){var t,n,i,s,u;if(Array.isArray(r)){for(s={},t=0,i=r.length;t<i;t++)"object"==typeof(n=r[t])?Object.assign(s,n):"function"==typeof n&&(null==s.pipes&&(s.pipes=[]),s.pipes.push(n));u=s}else u=r;return null==u.pipes&&(u.pipes=u.pipe||u.pipeline||[]),Array.isArray(u.pipes)||(u.pipes=[u.pipes]),null==u.entry&&(u.entry=u.entries||u.input||u.inputs||[]),u.workdir=u.workdir||u.dir||u.dirname||"./",u.workdir?u.workdir=path.resolve(e.dirname,u.workdir):u.workdir=path.resolve(e.dirname),u}},{dev:t}};